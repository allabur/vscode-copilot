# ü§ñ AI Coding & Contribution Guidelines for {{ project_name }}

These guidelines define the **coding, documentation, and collaboration standards** for this project. They must be followed for all contributions, whether authored by humans or generated by AI systems.

---

## üì¶ Project-Wide Conventions

-   **Language:** All code, comments, identifiers, and documentation must be written in **English**.
-   **Structure:** Maintain a clean, modular, and layered architecture. Group related files and respect package boundaries.
-   **Imports:**
    -   Use **absolute imports** within the main package for clarity and maintainability.
    -   Use **relative imports** (`from .module import ...`) only within submodules or sibling files.
    -   Avoid wildcard imports (`from module import *`).
    -   Order imports using [PEP 8](https://peps.python.org/pep-0008/#imports): standard library ‚Üí third-party ‚Üí local application.

---

## ‚úÖ Git & Collaboration

### üîÄ Version Control Practices

-   Use **descriptive branch names**, e.g., `feature/data-cleaning`, `bugfix/parser-timezone`.
-   Rebase over main (`git pull --rebase`) before submitting a pull request.
-   Squash commits if necessary to keep history clean.

### ‚úÖ Commit Message Format (Extended)

We follow the [Conventional Commits](https://www.conventionalcommits.org/en/v1.0.0/) standard with some **extensions** for clarity and automation.

```
<type>(<scope>): <short description>

<body: optional, wrapped at 72 characters>

<footer: optional - links to issues, breaking changes, etc.>
```

#### Examples

```bash
feat(patient): add rank mapping by admission date
fix(ed): correct NaN bug in discharge event logs
docs(contributing): update commit message format and husky usage

BREAKING CHANGE: 'patient_id' is now a required field.
```

#### Types

-   `feat`: A new feature
-   `fix`: A bug fix
-   `docs`: Documentation only
-   `style`: Formatting (no logic change)
-   `refactor`: Refactor without fixing a bug or adding a feature
-   `test`: Adding or fixing tests
-   `chore`: Maintenance (build tools, CI, etc.)

#### Scopes

Use kebab-case scopes matching folder or domain areas:
`core`, `ed`, `iu`, `parser`, `patient`, `utils`, `docs`, `config`, etc.

#### Setup Commit Linting (optional but recommended)

We use [`commitlint`](https://github.com/conventional-changelog/commitlint) + [`husky`](https://typicode.github.io/husky/) to enforce commit standards automatically.

1. Install:

    ```bash
    npm install --save-dev husky @commitlint/{config-conventional,cli}
    ```

2. Create `commitlint.config.js` and `.husky/commit-msg`.

3. Enable Husky:

    ```bash
    npx husky install
    npm run prepare
    ```

4. Every commit will be validated automatically.

Follow the [Conventional Commits](https://www.conventionalcommits.org/en/v1.0.0/) specification.

Examples:

```bash
feat: add normalization function for admission delays
fix: correct timezone offset handling in timestamp parser
refactor: extract reusable patient ID logic
test: add unit tests for signal transformation
```

---

## üìå General Principles

-   **Clarity First:** Optimize code for **readability**, **maintainability**, and **performance**‚Äîin that order.
-   **Consistency:** Follow existing patterns in the codebase. When in doubt, mimic what's already there.
-   **Minimalism:** Prefer fewer lines, fewer dependencies, and fewer side effects.

---

## üß± Coding Standards

-   Follow **SOLID principles** to ensure modularity and scalability.
-   Conform to **PEP 8** for style and layout.
-   Use **descriptive and consistent names** for functions, variables, and classes.
-   Each function should:
    -   Do **one thing** and do it well.
    -   Be short, readable, and testable.
    -   Avoid side effects unless explicitly documented.

---

## üóÇÔ∏è Commenting & Code Structure

-   Use **step-wise comments** for each major block in a function:

    ```python
    # Step 1: Filter by admission date
    ```

    ‚ö†Ô∏è _Do not number comments related to default `kwargs` extraction._

-   **Inline comments** should be rare, used only when necessary to clarify complex logic.
-   Separate logical sections with **blank lines** to improve readability.

---

## üìö Documentation Standards

-   All public modules, classes, and functions must include **docstrings** in **reStructuredText (reST)** format.

### Docstring Format

```
def calculate_delay(...):
    """
    Compute average delay between events.

    :param start_time: Starting timestamp.
    :type start_time: datetime
    :param end_time: Ending timestamp.
    :type end_time: datetime
    :return: Delay in minutes.
    :rtype: float
    """
```

-   Include:
    -   Summary line.
    -   Parameter list with `:param` and `:type`.
    -   Return value with `:return:` and `:rtype:`.
    -   Use `:raises:` and `Example:` where appropriate.

---

## üß™ Testing Requirements

-   Use `pytest` (or similar) for **unit tests**.
-   Tests must:
    -   Live in a **mirrored structure** under the `/tests/` directory.
    -   Cover **normal cases**, **edge cases**, and **error handling**.
    -   Be named using the pattern: `test_<function>_<behavior>()`.

### Example Test Structure:

```
/src/
  ‚îî‚îÄ‚îÄ utils/
        ‚îî‚îÄ‚îÄ parser.py

/tests/
  ‚îî‚îÄ‚îÄ utils/
        ‚îî‚îÄ‚îÄ test_parser.py
```

---

## üöÄ Optimization Guidelines

-   Optimize for both **performance** and **readability**.
-   Use:
    -   **Vectorized operations** with `pandas` and `numpy` where possible.
    -   **Modern Python idioms**: comprehensions, unpacking, context managers, etc.
-   Avoid premature optimization. Always **measure before refactoring**.
-   Only modify logic if:
    -   Fixing a **documented bug**, or
    -   **Improving clarity or performance** without changing behavior.

---

## üß∞ Dependencies & Environments

-   Use only **well-maintained and widely adopted** packages:
    -   e.g. `pandas`, `numpy`, `scikit-learn`, `matplotlib`, `seaborn`, `networkx`, `pm4py`, `openpyxl`
-   Define environments with:
    -   `requirements.txt` or `pyproject.toml`
    -   Always use **pinned versions** (`package==x.y.z`) for reproducibility.

---

## üîç Code Review Checklist

Before submitting code, confirm the following:

-   [ ] Code follows PEP 8 style.
-   [ ] Functions are small, clear, and testable.
-   [ ] Descriptive and consistent naming is used.
-   [ ] Step-wise comments explain each logic block.
-   [ ] All public elements are documented with reST docstrings.
-   [ ] No redundant or dead code exists.
-   [ ] Unit tests exist for all new functions and cover edge cases.
-   [ ] Logic is unchanged unless explicitly needed.
-   [ ] All dependencies are necessary and version-pinned.
-   [ ] Code runs efficiently and is easy to read.

---

## Naming Style Guide

-   **kebab-case**: For documentation files and folders (e.g., `user-guide.md`, `docs/project-overview/`).
-   **snake_case**: For Python files, modules, and variable/function names (e.g., `data_loader.py`, `my_function`).
-   **PascalCase**: For Python class names (e.g., `DataProcessor`).
-   **UPPER_SNAKE_CASE**: For constants in Python (e.g., `MAX_ITERATIONS`).
-   **camelCase**: Only for JavaScript or JSON keys if needed.
-   All names must be in English, descriptive, and consistent.

Apply these conventions to all code, documentation, and generated files in this project.

---

_Inspired by best practices from projects such as FastAPI, PyTorch, and Airflow._
